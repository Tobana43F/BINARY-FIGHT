# BINARY FIGHT

## 🎮ゲーム紹介

|||
|---|---|
|タイトル|BINARY FIGHT| 
|ジャンル|2D対戦格闘ゲーム| 
|プレイ人数|1～2人| 
|動作環境|Windows, Wii| 

### ゲーム概要

**ストリートファイターシリーズ** を参考に開発した2D格闘ゲームです。

近距離でのインファイトがメインのシステムとなっており、シンプルながらも駆け引きのあるゲームプレイを目指しました。

このゲームでの一番の要素は **足払い** です。  
足払いで差仕返し、その後の起き攻めをいかにして行うかが勝敗を分けます。

## 🛠️技術的な見どころ

### フルスクラッチ開発

ゲームエンジンを使わず、C++, DirectXを用いて、ウィンドウ表示、ポリゴンの描画、アニメーションの仕組の実装など、  
基盤部分からアプリケーション部分まで全ての実装を行っています。

### マルチプラットフォーム対応

この制作はもともとWii環境での作品になります。  
ポリゴン描画やテクスチャファイルの読み込みなど、環境に依存する処理をifdefなどのプリプロセッサを活用して対応しています。

Wii環境だけでの実装では、開発場所の制限があり、制作時間が確保できずクオリティアップが難しかったですが、  
PCでも同様に動かせるようにしたことで、十分に作品を作りこむことができました。

### ポリモーフィズムを意識した実装

キャラクターの共通処理をActorクラスにまとめ、キャラを追加する際に固有の処理だけを実装することで追加できるようにしています。

キャラクターのCPUの実装について、キャラクタークラスを継承し、  
操作関数をオーバーライドすることで、コンピュータの実装のみに集中できるようにしました。

### デバッグ表示の実装

複数ある当たり判定を別々の色で表示するようにし、直観的に判断できるようなデバッグ表示を実装しています。
さらに、細かい入力状態や内部ステートを一覧できるよなデバッグ表示も実装し、効率的なデバッグ作業ができるようにしました。

<img height="250" alt="ヒットボックス表示" src="https://github.com/user-attachments/assets/d8a4755b-112a-4193-bb2d-b77dadd9f15a" /> <img height="250" alt="デバッグ表示" src="https://github.com/user-attachments/assets/73550555-7bed-4a71-ab17-41b682a7c450" />

## ✨こだわり・アピールポイント

### 手触りの良いキャラクター制御

ストリートファイターの滑らかな操作感を再現するために、フレーム単位のステート制御を行っています。  

立からしゃがみへの移行や、たち状態での振りむき、空中攻撃復帰など、細かなステートを実装し、  
操作がすぐに画面に反映され、触っていて気持ちの良い捜査官を実現しました。  

ノックダウン時にスローモーション演出を入れるなど細かい部分にもこだわりを持って実装を行いました。

<img height="300" alt="ヒットボックス表示" src="https://github.com/user-attachments/assets/052df843-ef45-4cab-a3cf-79c6878a89ac" />

### 格闘ゲームの細かな仕様を実現

#### ジャンプ移行フレームの実装

ジャンプ移行フレームを実装し、入力からジャンプ開始までには4フレームかかるようにしています。
これにより、ジャンプを押しっぱなしにして空中ヒットで相手にコンボをさせないというような状況を回避しています。

#### 着地硬直の実装

ジャンプ中に攻撃を出したときのみ、着地硬直が発生するように実装しています。  
相手のジャンプ攻撃を避け、足払いを確定させるというような戦術が可能になり、ジャンプ攻撃にもリスクがつくように実装しています。  
ジャンプ攻撃を出さなかった場合は、着地硬直を特定の行動でキャンセルすることができ、着地狩りをガードできます。

#### めくり判定の実装

相手を飛び越えて攻撃をヒットさせた場合は、めくり攻撃判定をおこない、  
相手のノックバックを、飛び越える前に攻撃した際の方向にすることで、自キャラに近づく動きになりコンボを繋げやすくしています。

#### 画面端での自キャラのノックバックの実装

相手を攻撃すると相手がノックバックしますが、画面端ではノックバックするスペースがないため、そのままだと永久コンボができてしまう。  
相手が画面端に到達してからのノックバックは、自キャラに反映することで、そのような状況を避けています。

#### 影縫い判定の実装

攻撃には攻撃判定以外に、相手を強制的にガードモーションにさせる、影縫い判定も実装しています。
足払いを避けるために間合いを調整しようとする相手を影縫い状態にし、足払いをヒットさせるような戦術が可能です。

### チュートリアルの実装

チュートリアルモードを用意し、初めて触るプレイヤーにも遊びやすいようにしています。
歩きやジャンプの基本操作から、上中下段のガード方法なども説明しています。

<img height="300" alt="ヒットボックス表示" src="https://github.com/user-attachments/assets/8f91e1ab-ee45-4fd4-83b6-225f6dee0bd3" />

### ほぼ全てのテクスチャリソースを自作

キャラクターのドットやアニメーションを自分で作成し、  
触っていて楽しくなるような滑らかなアニメーションを実現しました。

それ以外のヒット・ガードエフェクト、ゲーム内のUI、ステージ背景なども自作しています。

<img height="250" alt="Char_Dots_Normal" src="https://github.com/user-attachments/assets/91e31f6b-376a-4184-883d-1e13d4d01bf1" />
<img height="250" alt="BattleEffect_HighAttack" src="https://github.com/user-attachments/assets/313f175d-6d03-4127-b79d-f1e36ed6b1eb" />
<img height="250" alt="BattleEffect_HighGuard" src="https://github.com/user-attachments/assets/2d7ad3f6-9c95-4058-a9c7-746bcec0d8b8" />

## 🔍自己レビュー

### マルチプラットフォームの実現方法について

各関数内でifdefすることで実装を分けているが、同じソースコード上に全プラットフォームの実装が書かれていて可読性が悪くなっている。  
cppを分けて実装をしたほうが可読性が上がる。

### 各種画面（シーン）の実装を共通化したい

タイトルやモード選択などの画面の実装が、クラスとして共通化されていない。  
そのため、画面が増えるたびに、専用のインスタンスを書き、更新や描画、破棄処理を追加する必要がある。

その後のプロジェクトでは、この点を改善できている。  
- [JoinToJoint](https://github.com/Tobana43F/JoinToJoint)  
- [InfightAction](https://github.com/Tobana43F/InfightAction)  

### コマンド入力について

当時の実力と開発期間では複雑なコマンド入力の実装を行うことができませんでした。

企画の方針としても、シンプルに遊べるゲームにするために複雑なコマンドは使わず、  
「方向キー + 攻撃ボタン」で技を出せるようにする方針で進めました。  
足払いは、「↘ + 攻撃ボタン」で出すことができます。  

社会人になってから、小規模のチームでコマンドを活かしたゲームを作る機会があり、その際はコマンドシステムの実装を担当。  
波動・昇竜コマンドやソニックブームのような溜めコマンドにも対応。  
キャラのデータを編集するだけで、好きなコマンドを自由に追加できるような仕組みを実装しました。

以下は、モックの作成として実装を進めたリポジトリになります。  
[FightingTrainer](https://github.com/Tobana43F/FightingTrainer)

## 🛠開発情報

|||
|---|---|
|開発環境|C++, DirectX9<br>Wii環境 (コードからは削除済み)|
|開発人数|1人|
|開発時期|2016年前期|
|開発期間|約5カ月|

### 使用ツール

- Visual Studio
- SVN, TortoiseSVN
- Excel
- GIMP2
- Audacity
